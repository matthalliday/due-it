<section>
	<h1 class="page-title"><%= @due_window.titleize %></h1>
	<% if @tasks.empty? %>
		<%= content_tag(:p, "Looks like there's nothing #{@due_window.humanize.downcase}!", class: 'page-message') %>
	<% end %>

	<% @projects.each do |project| %>
		<article class="project">
			<div class="name">
				<h1><%= link_to project.name, project %></h1>
				<span class="highlight"></span>
			</div>

			<div class="info-bar clearfix">
				<p class="count"><%= pluralize(project.incomplete_tasks, 'incomplete task', 'incomplete tasks') %></p>
				<%= link_to 'Add Task', new_project_task_path(project), class: 'button' %>
			</div>

			<ul class="task-list">
				<% project.tasks.incomplete.send(@due_window).each do |task| %>
					<li>
						<h2><%= link_to task.name, [project, task] %></h2>
						<div class="meta clearfix">
							<p>Estimate: <%= task.estimate %></p>
							<p>Due: <%= task.due_date.strftime('%B %-d') %></p>
							<p>Priority: <%= task.priority.titleize %></p>

							<% if task.status == 'incomplete' %>
								<%= link_to 'Complete', mark_task_complete_path(project, task), method: :put, class: 'task-action complete' %>
							<% end %>
						</div>
					</li>
				<% end %>
			</ul><!-- /.task-list -->
		</article><!-- /.project -->
	<% end %>
</section>